SELECT DISTINCT m.MEAL_NAME
FROM MEAL m
JOIN INGREDIENT i ON m.MEAL_ID = i.MEAL_ID
WHERE i.NAME = 'Garlic';

SELECT COUNT(DISTINCT m.MEAL_ID) AS NUM_MEALS
FROM MEAL m
JOIN INGREDIENT i ON m.MEAL_ID = i.MEAL_ID
WHERE i.VEGETARIAN = true;

SELECT m.NAME
FROM MEAL m
JOIN INGREDIENT i ON m.MEAL_ID = i.MEAL_ID
GROUP BY m.NAME
HAVING MAX(CASE WHEN i.GLUTEN_FREE = true THEN 1 ELSE 0 END) = 1
AND MAX(CASE WHEN i.VEGAN = true THEN 1 ELSE 0 END) = 1;


SELECT AVG(num_ingredients) AS AVERAGE_INGREDIENTS_FOR_MEAL
 FROM (
     SELECT m.MEAL_ID, COUNT(i.INGREDIENT_ID) AS NUM_INGREDIENT
     FROM MEAL m
     JOIN INGREDIENT i ON m.MEAL_ID = i.MEAL_ID
     GROUP BY m.MEAL_ID
 ) AS INGREDIENT_COUNT;


SELECT m.NAME
FROM MEAL m
JOIN INGREDIENT i ON m.MEAL_ID = i.MEAL_ID
GROUP BY m.NAME
HAVING COUNT(*) > 3;



SELECT *
FROM CUSTOMER c
INNER JOIN "ORDER" o ON c.CUSTOMER_ID = o.CUSTOMER_ID;


SELECT *
FROM PRODUCT p
INNER JOIN INVENTORY i ON p.PRODUCT_ID = i.PRODUCT_ID;